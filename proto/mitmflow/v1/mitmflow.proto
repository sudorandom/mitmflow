edition = "2023";

package mitmflow.v1;

import "google/protobuf/go_features.proto";
import "mitmproxygrpc/v1/service.proto";

option features.field_presence = EXPLICIT;

service Service {
  rpc StreamFlows(StreamFlowsRequest) returns (stream StreamFlowsResponse) {}
}

message StreamFlowsRequest {}

message StreamFlowsResponse {
  mitmproxy.v1.Flow flow = 1;
}

message MessageDetails {
  repeated string textual_frames = 1;
  string effective_content_type = 2;
}

extend mitmproxy.v1.Request {
  MessageDetails request_details = 2666;
}

extend mitmproxy.v1.Response {
  MessageDetails response_details = 2666;
}
