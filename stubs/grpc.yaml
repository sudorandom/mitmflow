---
stubs:
- id: grpc
  target: mitmflow.v1.Service/StreamFlows
  cel_content: |
    {
      "flow": {
        "http_flow": {
          "id": fake_uuid(),
          "request": {
            "method": "POST",
            "url": fake_url()+'/someservice.SomeService/SomeMethod',
            "headers": {
              "User-Agent": fake_user_agent(),
              "Content-Type": "application/grpc",
              "grpc-accept-encoding": "identity,deflate,gzip",
              "te": "trailers",
            },
            "http_version": "HTTP/2",
            "timestamp_start": fake_date(),
            "timestamp_end": fake_date(),
            "pretty_url": fake_url()+'/someservice.SomeService/SomeMethod',
            "content_truncated": false,
            "effective_content_type": "application/grpc",
          },
          "response": {
            "status_code": 200,
            "headers": {
              "Content-Type": "application/grpc",
              "Server": fake_product_name(),
              "grpc-status": "0",
              "grpc-message": "OK",
            },
            "content": b'',
            "content_protoscope_frames": [
              '1: "jane.doe"\n2: "jane.doe@example.com"',
              '1: "grpc"\n2: 1',
              '1: "/search?q=one"\n1: "/search?q=two"',
              '1: 12345\n2: "My Item"',
            ],
            "http_version": "HTTP/2",
            "timestamp_start": fake_date(),
            "timestamp_end": fake_date(),
            "content_truncated": false,
            "effective_content_type": "application/grpc",
            "reason": "OK",
          },
          "timestamp_start": fake_date(),
          "duration_ms": fake_float32(),
          "client": {
            "peername_host": fake_i_pv4_address(),
            "peername_port": fake_int8(),
            "sockname_host": fake_i_pv4_address(),
            "sockname_port": fake_int8(),
            "id": fake_uuid(),
            "state": "CONNECTION_STATE_OPEN",
            "transport_protocol": "TRANSPORT_PROTOCOL_TCP",
            "tls": true,
            "sni": fake_domain_name(),
            "timestamp_start": fake_date(),
            "proxy_mode": "regular",
          },
          "server": {
            "peername_host": fake_i_pv4_address(),
            "peername_port": fake_int8(),
            "sockname_host": fake_i_pv4_address(),
            "sockname_port": fake_int8(),
            "id": fake_uuid(),
            "state": "CONNECTION_STATE_OPEN",
            "transport_protocol": "TRANSPORT_PROTOCOL_TCP",
            "tls": true,
            "sni": fake_domain_name(),
            "timestamp_start": fake_date(),
            "address_host": fake_i_pv4_address(),
            "address_port": fake_int8(),
          },
          "error": "",
          "is_websocket": false,
          "live": false,
        },
      },
    }
