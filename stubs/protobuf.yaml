---
stubs:
- id: protobuf
  target: mitmflow.v1.Service/StreamFlows
  cel_content: |
    {
      "flow": {
        "http_flow": {
          "id": fake_uuid(),
          "request": {
            "method": fake_http_method(),
            "url": fake_url()+'.pb',
            "headers": {
              "User-Agent": fake_user_agent(),
            },
            "http_version": "HTTP/3",
          },
          "response": {
            "status_code": fake_http_status_code(),
            "headers": {
              "Content-Type": "application/protobuf",
              "Server": fake_product_name(),
            },
            "content": b'0a400a26747970652e676f6f676c65617069732e636f6d2f70726f746f332e546573744d65737361676512161005420e65787065637465645f76616c756500000000',
            "content_protoscope_frames": [
              '1: {\n  1: {"type.googleapis.com/proto3.TestMessage"}\n  2: {`1005420e65787065637465645f76616c756500000000`}\n}',
            ],
            "http_version": "HTTP/3",
          },
          "timestamp_start": fake_date(),
          "duration_ms": fake_float32(),
          "client_ip": fake_i_pv4_address(),
        },
      },
    }
