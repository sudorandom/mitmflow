---
stubs:
- id: websockets
  target: mitmflow.v1.Service/StreamFlows
  cel_content: |
    {
      "flow": {
        "http_flow": {
          "id": fake_uuid(),
          "request": {
            "method": "GET",
            "url": fake_url(),
            "headers": {
              "User-Agent": fake_user_agent(),
              "Upgrade": "websocket",
              "Connection": "Upgrade"
            },
            "http_version": "HTTP/1.1"
          },
          "response": {
            "status_code": 101,
            "headers": {
              "Upgrade": "websocket",
              "Connection": "Upgrade"
            },
            "http_version": "HTTP/1.1"
          },
          "is_websocket": true,
          "websocket_messages": [
            {
              "content": base64.encode(b'Hello, server!'),
              "from_client": true,
              "timestamp": fake_date()
            },
            {
              "content": base64.encode(b'Hello, client!'),
              "from_client": false,
              "timestamp": fake_date()
            }
          ],
          "timestamp_start": fake_date(),
          "duration_ms": fake_float32(),
          "client": {
            "peername_host": fake_i_pv4_address(),
            "peername_port": fake_int8(),
            "sockname_host": fake_i_pv4_address(),
            "sockname_port": fake_int8(),
            "id": fake_uuid()
          },
          "server": {
            "peername_host": fake_i_pv4_address(),
            "peername_port": fake_int8(),
            "sockname_host": fake_i_pv4_address(),
            "sockname_port": fake_int8(),
            "address_port": fake_int8(),
            "address_host": fake_i_pv4_address(),
            "id": fake_uuid()
          }
        }
      }
    }
